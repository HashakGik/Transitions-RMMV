<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Melt.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Melt.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var Transitions = (function (my) {

    /**
     * DOOM melt transition class. Makes the old scene melt vertically, revealing the new scene.
     * @constructor
     * @memberOf Transitions
     * @extends Transitions.Transition_Base
     */
    var Transition_Melt = my.Transition_Melt = function () {
        this.initialize.apply(this, arguments);
    };

    Transition_Melt.prototype = Object.create(my.Transition_Base.prototype);
    Transition_Melt.prototype.constructor = Transition_Melt;

    /**
     * Constructor.
     * @param screen Sprite on which the transition will be drawn.
     * @param white Ignored.
     * @param fadeSign Sign parameter. Only fade outs (+1) will melt the screen.
     */
    Transition_Melt.prototype.initialize = function (screen, white, fadeSign) {
        my.Transition_Base.prototype.initialize.call(this, screen, white, fadeSign);

        this.slices = 500;
        this.snap = $gameSystem.snap;
    };

    /**
     * Starts the effect. The actual duration is twice the passed value.
     * @param duration Duration of the effect.
     */
    Transition_Melt.prototype.start = function (duration) {
        if (this.fadeSign > 0) {
            this.heights = [];
            this.heights.push(-Math.floor(Math.random() * 100));
            for (var i = 1; i &lt; this.slices; i++) {
                var tmp = Math.floor(Math.random() * 50) - 25 + this.heights[this.heights.length - 1];
                if (tmp > 0) {
                    tmp = 0;
                }
                this.heights.push(tmp);
            }

            this.duration = duration * 2;
            this.remainingDuration = duration * 2;
            this.active = true;
        }
    };

    Transition_Melt.prototype.update = function () {
        if (this.active) {
            var w = Math.ceil(this.snap.width / this.slices);
            var h = this.snap.height;

            this.screen._bitmap.clear();
            this.active = false;

            for (var i = 0; i &lt; this.slices; i++) {
                this.heights[i] += Math.floor(this.snap.height / this.duration);
                this.active |= this.heights[i] &lt;= this.screen.height;
            }

            for (var i = 0; i &lt; this.slices; i++) {
                var dh = (this.heights[i] &lt; 0) ? 0 : this.heights[i];

                this.screen._bitmap.blt(this.snap, i * w, 0, w, h, i * w, dh, w, h);
            }

            this.remainingDuration--;
        }
    };

    my.transitions['melt'] = "my.Transition_Melt";

    return my;
})(Transitions || {});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Transitions.html">Transitions</a></li></ul><h3>Classes</h3><ul><li><a href="Transitions.Transition_Base.html">Transition_Base</a></li><li><a href="Transitions.Transition_Cut.html">Transition_Cut</a></li><li><a href="Transitions.Transition_Iris.html">Transition_Iris</a></li><li><a href="Transitions.Transition_Melt.html">Transition_Melt</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.2</a> on Thu Sep 05 2019 21:35:35 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
